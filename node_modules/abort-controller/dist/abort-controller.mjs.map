{"version":3,"file":"abort-controller.mjs.map","sources":["../src/abort-signal.mjs","../src/abort-controller.mjs"],"sourcesContent":["import { EventTarget, defineEventAttribute } from \"event-target-shim\"\n\n/**\n * Aborted flag for each instances.\n * @type {WeakMap<AbortSignal, boolean>}\n */\nconst abortedFlags = new WeakMap()\n\n/**\n * The signal class.\n * @constructor\n * @see https://dom.spec.whatwg.org/#abortsignal\n */\nexport default function AbortSignal() {\n    EventTarget.call(this)\n    abortedFlags.set(this, false)\n}\n\n// Properties should be enumerable.\nAbortSignal.prototype = Object.create(EventTarget.prototype, {\n    constructor: {\n        value: AbortSignal,\n        configurable: true,\n        writable: true,\n    },\n\n    /**\n     * Returns `true` if this `AbortSignal`'s `AbortController` has signaled to abort, and `false` otherwise.\n     * @property\n     * @memberof AbortSignal\n     * @name aborted\n     * @type {boolean}\n     */\n    aborted: {\n        get: function get_aborted() { //eslint-disable-line camelcase\n            const aborted = abortedFlags.get(this)\n            console.assert(typeof aborted === \"boolean\", \"Expected 'this' to be an 'AbortSignal' object, but got\", this)\n            return Boolean(aborted)\n        },\n        configurable: true,\n        enumerable: true,\n    },\n\n    /**\n     * The event attribute for `abort` event.\n     * @property\n     * @memberof AbortSignal\n     * @name onabort\n     * @type {Function}\n     */\n})\n\ndefineEventAttribute(AbortSignal.prototype, \"abort\")\n\n/**\n * Abort a given signal.\n * @param {AbortSignal} signal The signal to abort.\n * @returns {void}\n */\nexport function abortSignal(signal) {\n    if (abortedFlags.get(signal) !== false) {\n        return\n    }\n\n    abortedFlags.set(signal, true)\n    signal.dispatchEvent({ type: \"abort\" })\n}\n","import AbortSignal, { abortSignal } from \"./abort-signal.mjs\"\n\n/**\n * Associated signals.\n * @type {WeakMap<AbortController, AbortSignal>}\n */\nconst signals = new WeakMap()\n\n/**\n * Get the associated signal of a given controller.\n * @param {AbortController} controller The controller to get its associated signal.\n * @returns {AbortSignal} The associated signal.\n */\nfunction getSignal(controller) {\n    const signal = signals.get(controller)\n    console.assert(signal != null, \"Expected 'this' to be an 'AbortController' object, but got\", controller)\n    return signal\n}\n\n/**\n * The AbortController.\n * @constructor\n * @see https://dom.spec.whatwg.org/#abortcontroller\n */\nexport default function AbortController() {\n    signals.set(this, new AbortSignal())\n}\n\n// Properties should be enumerable.\nObject.defineProperties(AbortController.prototype, {\n    /**\n     * Returns the `AbortSignal` object associated with this object.\n     * @type {AbortSignal}\n     */\n    signal: {\n        get: function get_signal() { //eslint-disable-line camelcase\n            return getSignal(this)\n        },\n        configurable: true,\n        enumerable: true,\n    },\n\n    /**\n     * Abort and signal to any observers that the associated activity is to be aborted.\n     * @returns {void}\n     */\n    abort: {\n        value: function abort() {\n            // Not depend on this.signal which is overridable.\n            const signal = getSignal(this)\n            if (signal != null) {\n                abortSignal(signal)\n            }\n        },\n        configurable: true,\n        enumerable: true,\n        writable: true,\n    },\n})\n\nexport { AbortController, AbortSignal }\n"],"names":[],"mappings":";;;;;;;AAEA;;;;AAIA,MAAM,YAAY,GAAG,IAAI,OAAO,GAAE;;;;;;;AAOlC,AAAe,SAAS,WAAW,GAAG;IAClC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAC;IACtB,YAAY,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,EAAC;CAChC;;;AAGD,WAAW,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,SAAS,EAAE;IACzD,WAAW,EAAE;QACT,KAAK,EAAE,WAAW;QAClB,YAAY,EAAE,IAAI;QAClB,QAAQ,EAAE,IAAI;KACjB;;;;;;;;;IASD,OAAO,EAAE;QACL,GAAG,EAAE,SAAS,WAAW,GAAG;YACxB,MAAM,OAAO,GAAG,YAAY,CAAC,GAAG,CAAC,IAAI,EAAC;YACtC,OAAO,CAAC,MAAM,CAAC,OAAO,OAAO,KAAK,SAAS,EAAE,wDAAwD,EAAE,IAAI,EAAC;YAC5G,OAAO,OAAO,CAAC,OAAO,CAAC;SAC1B;QACD,YAAY,EAAE,IAAI;QAClB,UAAU,EAAE,IAAI;KACnB;;;;;;;;;CASJ,EAAC;;AAEF,oBAAoB,CAAC,WAAW,CAAC,SAAS,EAAE,OAAO,EAAC;;;;;;;AAOpD,AAAO,SAAS,WAAW,CAAC,MAAM,EAAE;IAChC,IAAI,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,KAAK,EAAE;QACpC,MAAM;KACT;;IAED,YAAY,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,EAAC;IAC9B,MAAM,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,EAAC;CAC1C;;AChED;;;;AAIA,MAAM,OAAO,GAAG,IAAI,OAAO,GAAE;;;;;;;AAO7B,SAAS,SAAS,CAAC,UAAU,EAAE;IAC3B,MAAM,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,UAAU,EAAC;IACtC,OAAO,CAAC,MAAM,CAAC,MAAM,IAAI,IAAI,EAAE,4DAA4D,EAAE,UAAU,EAAC;IACxG,OAAO,MAAM;CAChB;;;;;;;AAOD,AAAe,SAAS,eAAe,GAAG;IACtC,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,WAAW,EAAE,EAAC;CACvC;;;AAGD,MAAM,CAAC,gBAAgB,CAAC,eAAe,CAAC,SAAS,EAAE;;;;;IAK/C,MAAM,EAAE;QACJ,GAAG,EAAE,SAAS,UAAU,GAAG;YACvB,OAAO,SAAS,CAAC,IAAI,CAAC;SACzB;QACD,YAAY,EAAE,IAAI;QAClB,UAAU,EAAE,IAAI;KACnB;;;;;;IAMD,KAAK,EAAE;QACH,KAAK,EAAE,SAAS,KAAK,GAAG;;YAEpB,MAAM,MAAM,GAAG,SAAS,CAAC,IAAI,EAAC;YAC9B,IAAI,MAAM,IAAI,IAAI,EAAE;gBAChB,WAAW,CAAC,MAAM,EAAC;aACtB;SACJ;QACD,YAAY,EAAE,IAAI;QAClB,UAAU,EAAE,IAAI;QAChB,QAAQ,EAAE,IAAI;KACjB;CACJ,CAAC;;;;;"}